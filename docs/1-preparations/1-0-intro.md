# åºè®º <Badge text="New"/>

![](https://cdn.spencer.felinae98.cn/github/2020/09/200902_220309.png)

::: callout ğŸ³ æœ¬ç« å†…å®¹
æ¬¢è¿æ¥åˆ° **Dev on Windows with WSL â€”â€” å¯èƒ½æ˜¯å¸‚é¢ä¸Šæœ€è¯¦å°½çš„ä¸­æ–‡ WSL å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—** çš„æ–‡æ¡£ç°åœºï¼Œæœ¬ç« æˆ‘ä»¬å°†å¯¹ WSL æœ¬èº«ã€WSL è¿‘æœŸæ›´æ–°å’Œ WSL çš„ä¼˜è¶Šç‰¹æ€§è¿›è¡Œç®€å•ä»‹ç»ï¼Œå¸¦é¢†ä½ ç†Ÿæ‚‰åˆ©ç”¨ WSL åœ¨ Windows ä¸Šé¢å¼€å‘å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†ã€‚
:::

## ä»€ä¹ˆæ˜¯ WSL

WSL çš„å…¨ç§°å«åšï¼šWindows Subsystem for Linuxï¼Œå³ã€Œé€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿã€ã€‚WSL çš„è¯ç”Ÿè®© Windows ç”¨æˆ·ï¼ˆå¼€å‘äººå‘˜ï¼‰æŒ‰åŸæ ·è¿è¡Œ GNU/Linux ç¯å¢ƒ â€”â€” åŒ…æ‹¬å¤§å¤šæ•°å‘½ä»¤è¡Œå·¥å…·ã€å®ç”¨å·¥å…·å’Œåº”ç”¨ç¨‹åº â€”â€” ä¸”ä¸ä¼šäº§ç”Ÿè™šæ‹Ÿæœºå¼€é”€ã€‚

## ç”¨ WSL å¯ä»¥åšä»€ä¹ˆï¼Ÿ

> ä»€ä¹ˆé¬¼ï¼Ÿä½ ä¸Šé¢é‚£ä¸€å¤§å †ä¸œè¥¿è¯´çš„éƒ½æ˜¯å•¥ï¼Ÿèƒ½è®²ä¸­æ–‡å—ï¼Ÿ(â•¬â–” çš¿ â–”)â•¯

å¥½çš„ï¼Œåœ¨ Windows ä¸Šç”¨ WSL æˆ‘ä»¬åˆ°åº•èƒ½å¹²ä»€ä¹ˆå‘¢ï¼Ÿ[^1]

- ä½ å¯ä»¥åœ¨ Windows ä¸Šã€Œå®‰è£…ã€ä½ å–œæ¬¢çš„ GNU/Linux å‘è¡Œç‰ˆ
- ä½ å¯ä»¥ç›´æ¥åœ¨ Windows ä¸Šè¿è¡Œ `grep`ã€`awk`ã€`sed` ç­‰ Linux åŸç”Ÿå¯æ‰§è¡Œæ–‡ä»¶
- ä½ å¯ä»¥åœ¨ Windows ä¸Šç›´æ¥ä½¿ç”¨ Vimã€Emacs ç­‰å·¥å…·ï¼Œç›´æ¥ä½¿ç”¨ Linux ç‰ˆæœ¬çš„ Javascript/Node.jsã€Rubyã€Pythonã€C/C++ã€Rustã€Go ç­‰è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œç›´æ¥è¿è¡Œ MySQLã€Apache ç­‰ Linux åŸç”Ÿåº”ç”¨å’ŒæœåŠ¡ç­‰

æœ€ä¸ºé‡è¦çš„æ˜¯ï¼Œåˆ©ç”¨ WSL æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨ **ä¸æŠ›å¼ƒ Windows å…¨éƒ¨ä¼˜ç§€å·¥å…·çš„å‰æä¸‹**ï¼Œ**åœ¨æ²¡æœ‰å› ä¸ºè™šæ‹Ÿæœºå¼€é”€è€Œç‰ºç‰²å¤ªå¤šæ€§èƒ½çš„æƒ…å†µä¸‹**ï¼Œç›´æ¥è¿è¡Œä½¿ç”¨å®Œæ•´çš„ Linux ç³»ç»Ÿã€‚

åœ¨ [README çš„å‰è¨€](https://github.com/spencerwooo/dowww#%E5%89%8D%E8%A8%80)ä¸­ï¼Œæˆ‘æåˆ°äº†ï¼š

> Windows ç»™ç¼–ç¨‹åˆå­¦è€…å¸¦æ¥äº†å¾ˆå¤§çš„å›°éš¾ã€‚æ¯”å¦‚ç¼ºä¹å¥½ç”¨çš„åŒ…ç®¡ç†ç³»ç»Ÿã€ç»ˆç«¯ç¯å¢ƒéš¾çœ‹éš¾ç”¨ã€ç¯å¢ƒå˜é‡ä¸æ˜“é…ç½®ç­‰ç­‰ï¼Œè¿™äº›éƒ½è®© Windows åœ¨å¼€å‘ä½“éªŒä¸Šéš¾ä»¥åŒ¹æ•Œ Linux ç”šè‡³ macOSã€‚

WSL çš„è¶…èƒ½åŠ›ï¼Œå°±æ˜¯ä¸ºæˆ‘ä»¬æ‰«æ¸…äº† Windows å¯¹å¼€å‘äººå‘˜ä¸å‹å¥½çš„éšœç¢ï¼Œè®©æˆ‘ä»¬åœ¨ Windows ä¸ŠåŒæ ·äº«å— Linux ç­‰ Unix é£æ ¼ç³»ç»Ÿçš„å¼€å‘ç‰¹è‰²ã€‚

## WSL ä¸ WSL 2

::: callout ğŸ’¡ èƒŒæ™¯çŸ¥è¯†
WSL æ˜¯å¾®è½¯ 2016 å¹´æ˜¥å¤©å‘å¸ƒçš„é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿ 1.0 ç‰ˆæœ¬ï¼ŒWSL 2 æ˜¯ 2019 å¹´æ˜¥å¤©å¾®è½¯ä¸ºäº†è§£å†³ä¸€ç³»åˆ— WSL åœ¨ 1.0 ç‰ˆæœ¬ä¸­å‡ºç°çš„é—®é¢˜è€Œå¼€å‘çš„æ–°ã€Œæ¡†æ¶ã€ã€‚äºŒè€…éƒ½èƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬åœ¨ Windows ä¸Šé¢è¿›è¡Œ Linux åŸç”Ÿå¼€å‘ç¯å¢ƒéƒ¨ç½²çš„éœ€æ±‚ï¼Œ**ä½†æ˜¯ WSL 2 çš„åŸºå› æ›´ä¸ºä¼˜ç§€**ï¼Œèƒ½å¤Ÿé¿å… WSL åœ¨ 1.0 ç‰ˆæœ¬ä¸­ä½“ç°å‡ºçš„ç§ç§å±€é™æ€§ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ç®€å•ä»‹ç» WSL ä¸ WSL 2 å„è‡ªçš„ç‰¹ç‚¹å’Œä¼˜åŠ¿ã€‚
:::

ä»æŠ€æœ¯å±‚é¢æ¥è¯´ï¼ŒWSL å®è´¨ä¸Šå°±æ˜¯è®© Linux åŸç”Ÿçš„ ELF64 äºŒè¿›åˆ¶æ–‡ä»¶èƒ½å¤Ÿåœ¨ Windows ä¸Šé¢è¿è¡Œã€‚ä½†æ˜¯ç›®å‰ WSL å’Œ WSL 2 åœ¨å®ç°è¿™ä¸€åŠŸèƒ½çš„æ–¹æ³•ä¸Šå¤§æœ‰ä¸åŒã€‚

### WSL è¯ç”Ÿä¹‹åˆçš„å®ç°æ‰‹æ®µ

åœ¨ WSL æ—¶ä»£ï¼ˆä¹Ÿå°±æ˜¯ WSL 1.0 ç‰ˆæœ¬ï¼‰ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯é€šè¿‡ WSL å…¼å®¹å±‚æ¥å®ç°çš„ã€‚WSL åœ¨ 1.0 ç‰ˆæœ¬ä¸­ï¼Œæ˜¯ä¸€ç³»åˆ—ä¿è¯ Linux ELF64 äºŒè¿›åˆ¶æ–‡ä»¶èƒ½å¤Ÿåœ¨ Windows ä¸Šé¢è¿è¡Œçš„ç»„ä»¶çš„é›†åˆ[^2]ï¼Œè¿™å…¶ä¸­åŒ…å«äº†ã€Œç”¨æˆ·æ€ã€å’Œã€Œæ ¸å¿ƒæ€ã€çš„ç»„ä»¶ï¼Œä¸»è¦ç”±ä»¥ä¸‹å†…å®¹æ„æˆï¼š

- ç”¨æˆ·æ€ä¼šè¯è¿›ç¨‹ç»´æŒæœåŠ¡ï¼ˆUser mode session manager serviceï¼‰ï¼Œç”¨äºç»´æŠ¤ Linux å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ
- Pico è¿›ç¨‹é©±åŠ¨ â€”â€” Pico provider driversï¼ˆåŒ…æ‹¬ `lxss.sys`ã€`lxcore.sys`ï¼‰ï¼Œ**é€šè¿‡ç›´æ¥ç¿»è¯‘ã€ŒLinux ç³»ç»Ÿè°ƒç”¨ã€æ¥æ¨¡æ‹Ÿä¸€ä¸ª Linux å†…æ ¸**
- Pico è¿›ç¨‹æœ¬ä½“ â€”â€” Pico processes[^3]ï¼Œç”¨äºæ‰˜ç®¡ï¼ˆHostï¼‰åŸç”Ÿ Linux ç”¨æˆ·æ€è¿›ç¨‹ï¼ˆæ¯”å¦‚ `/bin/bash` ç­‰ï¼‰

![](https://i.loli.net/2020/01/04/b6OrutxehGVWRKI.png)^[[Windows for Linux Nerds](https://blog.jessfraz.com/post/windows-for-linux-nerds/)]

æœ€ä¸ºé‡è¦çš„å°±æ˜¯ WSL ä¸­é—´å…¼å®¹å±‚ï¼šPico provider driversï¼Œæ­£æ˜¯è¿™ä¸€å±‚è®© WSL èƒ½å¤Ÿå°† Linux è¿›ç¨‹ä¸­è¯·æ±‚çš„ç³»ç»Ÿè°ƒç”¨è½¬æ¢ä¸º Windows ç³»ç»Ÿè°ƒç”¨ã€‚

### WSL 2 ä¸­é‡‡ç”¨çš„æ–°æªæ–½

WSL çš„ 1.0 ç‰ˆæœ¬ç¡®å®ä¸º Windows å¸¦æ¥äº†æ–°é²œçš„è¡€æ¶²ï¼Œä½†æ˜¯ WSL è‡ªå‘å¸ƒä»¥æ¥å°±ä¼´éšç€ç”¨æˆ·å¯¹ã€Œåº”ç”¨æ€§èƒ½ã€ä»¥åŠã€ŒI/O é€Ÿåº¦ã€çš„æŠ±æ€¨ï¼Œè¿™äº›éƒ½æ˜¯ç”±äºå…¼å®¹å±‚çš„ç¼˜æ•…ï¼Œä½¿å¾— WSL åœ¨ 1.0 æ—¶ä»£ç‰ºç‰²äº†å¾ˆå¤šæ€§èƒ½ã€‚å¦å¤– WSL åœ¨ 1.0 æ—¶ä»£ä¹Ÿä¸æ”¯æŒ Docker ç­‰è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚é€šè¿‡å¼ºè¡Œã€Œç¿»è¯‘ã€Linux ç³»ç»Ÿè°ƒç”¨å¸¦æ¥çš„å±€é™æ€§åœ¨ WSL 1.0 ä¸­ä½“ç°çš„æ·‹æ¼“å°½è‡´ã€‚

WSL 2 æ˜¯ WSL å‘å±•å†å²ä¸­çš„çªç ´æ€§è¿›æ­¥ï¼Œä¸Šè¿°é—®é¢˜åœ¨ WSL 2 ä¸­å¾—åˆ°äº†æ ¹æœ¬æ€§çš„è§£å†³ã€‚

![](https://cdn.spencer.felinae98.cn/github/2020/09/200902_220309-1.png)

åœ¨ WSL 2 ä¸­ï¼Œå¾®è½¯ç›´æ¥å°†ä¸€ä¸ªå®Œæ•´çš„ Linux å†…æ ¸æ”¾åœ¨ WSL çš„æ¶æ„ä¹‹ä¸­[^4]ï¼Œé€šè¿‡ Hyper-V çš„æŠ€æœ¯ä¸º WSL æ„é€ ä¸€ä¸ªè½»é‡çº§ã€å‡ ä¹ä¸æ¶ˆè€—é¢å¤–ç³»ç»Ÿå¼€é”€çš„è™šæ‹Ÿç¯å¢ƒï¼Œä»è€Œè®© WSL 2 å®ç°äº†ï¼š

- åœ¨ Windows ä¸Šå®ç°å®Œæ•´çš„ Linux åŸç”Ÿç³»ç»Ÿè°ƒç”¨ï¼ˆFull System Call Compatibilityï¼‰
- ç”¨ WSL æ‰§è¡Œæ›¾ç» 1.0 ç‰ˆæœ¬æ— æ³•è¿è¡Œçš„ Linux åŸç”Ÿç¨‹åºï¼Œæ¯”å¦‚ä¾èµ–è™šæ‹ŸåŒ–æŠ€æœ¯çš„ Docker å®¹å™¨
- æå¤§çš„çªç ´äº† WSL 1.0 ä¸­å‡ºç°çš„ I/O æ€§èƒ½ç“¶é¢ˆï¼šWSL 2 ä¸­ï¼Œ`git clone`ã€`npm install`ã€`apt update`ã€`apt upgrade` ç­‰ä¾èµ–æ–‡ä»¶ç³»ç»Ÿæ€§èƒ½çš„æ“ä½œå’Œå‘½ä»¤çš„é€Ÿåº¦éƒ½æœ‰æ˜¾è‘—æé«˜

å¦å¤–ï¼Œè™½ç„¶ WSL 2 ä½¿ç”¨äº†è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä½†æ˜¯å®˜æ–¹å®£ç§°ï¼š

> WSL 2 uses the latest and greatest in virtualization technology to run its Linux kernel inside of a lightweight utility virtual machine (VM).
>
> WSL 2 ä½¿ç”¨çš„æ˜¯æœ€æ–°ã€æœ€å‰å®³çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œè®© Linux å†…æ ¸åœ¨ä¸€ä¸ªéå¸¸è½»é‡çº§çš„è™šæ‹Ÿæœºä¸­è¿è¡Œã€‚

å®é™…ä½¿ç”¨ä¸­ï¼Œä½ å‡ ä¹ä¸ä¼šå¯Ÿè§‰åˆ°å’Œ WSL 1.0 ç‰ˆæœ¬æœ‰ç‰¹åˆ«å¤§çš„åŒºåˆ«ï¼Œä¸è¿‡ WSL 2 è¿˜æ˜¯æœ‰ä¸€äº›å’Œ WSL 1 ä¸ä¸€æ ·çš„åœ°æ–¹ï¼š

- å¦‚æœä½ åœ¨ WSL 2 ä¸­è¿è¡Œ Web æœåŠ¡å™¨ï¼Œä½ ä¼šå‘ç°æ˜ å°„åˆ° Windows ä¸­çš„ç«¯å£å¹¶ä¸ä¸€æ ·ã€‚ä¸è¿‡è¿™ä¸€ä¸åŒå¹¶æ— å¤§ç¢
- ä½ ä¼šå‘ç° WSL 2 ä¸­åœ¨ Windows ä¾§å’Œ Linux ä¾§ä¹‹é—´ç›¸äº’ç§»åŠ¨æ–‡ä»¶çš„é€Ÿåº¦ä¼šæ¯” WSL çš„ 1.0 ç‰ˆæœ¬æ…¢ã€‚å› æ­¤ï¼Œä¸ºäº†å°½å¯èƒ½ä¿è¯æˆ‘ä»¬ WSL æ–‡ä»¶ç³»ç»Ÿçš„å­˜å‚¨é€Ÿåº¦ï¼Œ**æˆ‘ä»¬åº”è¯¥å°†åœ¨ Linux ä¸­ä½¿ç”¨çš„æ–‡ä»¶å…¨éƒ¨æ”¾åœ¨ Linux æ–‡ä»¶ç³»ç»Ÿä¸‹**[^6]
- WSL 2 ç›®å‰å¯¹ç¡¬ä»¶çš„æ”¯æŒæœ‰é™ï¼Œå› æ­¤ä½ æ— æ³•åœ¨ WSL 2 ä¸­ç›´æ¥è®¿é—® ~~GPU~~[^7][^8]ã€ä¸²å£æˆ– USB æ¥å£[^5]
- WSL 2 å¯¹ VMware ç­‰è™šæ‹Ÿæœºè½¯ä»¶ä¹Ÿæœ‰ä¸€äº›è¦æ±‚ï¼Œä¹Ÿå°±æ˜¯ï¼šä½ æ— æ³•åœ¨è¿è¡Œ WSL 2 çš„æƒ…å†µä¸‹ç›´æ¥è¿è¡Œ VMware æˆ–æ—§ç‰ˆæœ¬çš„ Virtual Boxã€‚è¿™æ˜¯å› ä¸º WSL 2 ä¸­çš„è™šæ‹ŸåŒ–æŠ€æœ¯ä¾èµ–äº Hyper-Vï¼Œè€Œ VMware å’Œ 6.0 ç‰ˆæœ¬ä¹‹å‰çš„ Virtual Box éƒ½å’Œ Hyper-V ä¸å…¼å®¹[^5]

é™¤æ­¤ä¹‹å¤–ï¼ŒWSL 2 å°±æ²¡æœ‰å…¶ä»–ç‰¹åˆ«å¤§çš„é—®é¢˜æˆ–å±€é™æ€§äº†ã€‚åœ¨æ¥ä¸‹æ¥çš„å®‰è£…ä¸­ï¼Œæˆ‘ä¼šç»§ç»­ä»‹ç»å¦‚ä½•å®‰è£…æŸä¸ª Linux å‘è¡Œç‰ˆã€å¦‚ä½•åˆå§‹åŒ–ä¸€ä¸ª Linux å‘è¡Œç‰ˆç¯å¢ƒã€å‘è¡Œç‰ˆå¦‚ä½•åœ¨ WSL 1 å’Œ WSL 2 ä¹‹é—´è¿›è¡Œåˆ‡æ¢ç­‰ç­‰ã€‚åŒå­¦ä»¬å¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€è¦ï¼Œåœ¨ WSL 1 å’Œ WSL 2 ä¹‹é—´è¿›è¡Œé€‰æ‹©ã€‚**å½“ç„¶ï¼Œæˆ‘è¿™é‡Œæ›´æ¨èå¤§å®¶ä½¿ç”¨æ€§èƒ½æ›´å¥½çš„ WSL 2ã€‚**

[^1]: [Windows Subsystem for Linux Documentation - Microsoft Docs](https://docs.microsoft.com/en-us/windows/wsl/about)
[^2]: [Windows Subsystem for Linux Overview - Microsoft Developer Blog](https://blogs.msdn.microsoft.com/wsl/2016/04/22/windows-subsystem-for-linux-overview)
[^3]: [Pico Process Overview - Microsoft Developer Blog](https://blogs.msdn.microsoft.com/wsl/2016/05/23/pico-process-overview/)
[^4]: [Shipping a Linux Kernel with Windows - Windows Command Line](https://devblogs.microsoft.com/commandline/shipping-a-linux-kernel-with-windows/)
[^5]: [WSL 2 Post BUILD FAQ - Windows Command Line](https://devblogs.microsoft.com/commandline/wsl-2-post-build-faq/)
[^6]: [User Experience Changes Between WSL 1 and WSL 2 - Microsoft Docs](https://docs.microsoft.com/en-us/windows/wsl/wsl2-ux-changes)
[^7]: [Enable NVIDIA CUDA in WSL 2](https://docs.microsoft.com/en-us/windows/win32/direct3d12/gpu-cuda-in-wsl)
[^8]: [Announcing CUDA on Windows Subsystem for Linux 2](https://developer.nvidia.com/blog/announcing-cuda-on-windows-subsystem-for-linux-2/)
